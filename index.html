<!DOCTYPE html>
<html lang="hy">
<head>
<meta charset="UTF-8">
<title>Ողջի գետի ջրի որակի վերլուծություն</title>

<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 0;
}
h2 {
  text-align: center;
  margin-top: 20px;
}
#map {
  height: 400px;
  margin: 20px;
}
.chart-container {
  width: 90%;
  margin: auto;
}
.analysis {
  width: 90%;
  margin: 20px auto;
  padding: 15px;
  background: #f2f7f5;
  border-left: 5px solid #2c7;
}
</style>
</head>

<body>

<h2>Ողջի գետի նմուշառման քարտեզ</h2>
<div id="map"></div>

<h2>Fe-ի որակի դասերի գրաֆիկ</h2>
<div class="chart-container">
  <canvas id="feChart"></canvas>
</div>

<h2>Շաբաթական վերլուծություն</h2>
<div class="analysis" id="weeklyAnalysis"></div>

<script>
/* ======================
   1. ՏՎՅԱԼՆԵՐ
====================== */
const samples = [
  { date: "2025-01-01", Fe: 2.1, lat: 39.205, lng: 46.405 },
  { date: "2025-01-05", Fe: 9.053, lat: 39.210, lng: 46.410 },
  { date: "2025-01-08", Fe: 4.3, lat: 39.215, lng: 46.415 },
  { date: "2025-01-12", Fe: 1.8, lat: 39.220, lng: 46.420 }
];

/* ======================
   2. ՈՐԱԿԻ ԴԱՍԵՐ (Ողջի գետ)
====================== */
function feClass(value) {
  if (value <= 0.3) return 1;
  if (value <= 1.0) return 2;
  if (value <= 2.0) return 3;
  if (value <= 5.0) return 4;
  return 5;
}

/* ======================
   3. ՔԱՐՏԵԶ
====================== */
const map = L.map('map').setView([39.21, 46.41], 12);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '© OpenStreetMap'
}).addTo(map);

samples.forEach(s => {
  const qClass = feClass(s.Fe);
  L.circleMarker([s.lat, s.lng], {
    radius: 8,
    color: qClass === 5 ? "red" : qClass === 4 ? "orange" : "green",
    fillOpacity: 0.8
  })
  .addTo(map)
  .bindPopup(
    `<b Ամսաթիվ:</b> ${s.date}<br>
     <b>Fe:</b> ${s.Fe}<br>
     <b>Որակի դաս:</b> ${qClass}`
  );
});

/* ======================
   4. ԳՐԱՖԻԿ
====================== */
const labels = samples.map(s => s.date);
const feClasses = samples.map(s => feClass(s.Fe));

new Chart(document.getElementById('feChart'), {
  type: 'line',
  data: {
    labels: labels,
    datasets: [{
      label: 'Fe – ջրի որակի դաս',
      data: feClasses,
      borderColor: 'blue',
      backgroundColor: 'rgba(0, 123, 255, 0.2)',
      tension: 0.3,
      pointRadius: 6
    }]
  },
  options: {
    scales: {
      y: {
        min: 1,
        max: 5,
        ticks: {
          stepSize: 1
        },
        title: {
          display: true,
          text: 'Ջրի որակի դաս'
        }
      }
    }
  }
});

/* ======================
   5. ՇԱԲԱԹԱԿԱՆ ՎԵՐԼՈՒԾՈՒԹՅՈՒՆ
====================== */
const avgClass =
  feClasses.reduce((a, b) => a + b, 0) / feClasses.length;

document.getElementById("weeklyAnalysis").innerHTML =
  `Շաբաթվա ընթացքում Fe-ի միջին որակի դասը կազմում է
   <b>${avgClass.toFixed(1)}</b>,
   ինչը վկայում է ջրի որակի
   <b>${Math.round(avgClass)}-րդ դասի</b>
   գերակշռության մասին։`;

</script>

</body>
</html>


